{
  "version": "2.4.1",
  "summary": {
    "title": "Threat Model",
    "owner": "Saamie Vincken",
    "description": "MeldMonitor is a law enforcement platform that helps police officers manage direct messages (DMs) received through their TikTok business accounts. Officers use a mobile app (built with Ionic/TypeScript) to log in to TikTok via an integration layer called DataDrip, which retrieves DMs and forwards them to MeldMonitor’s API Application for parsing and categorization.\n\nThe system’s Message Categorizer (Python-based ML service) analyzes incoming messages, labeling them by priority or risk. Urgent or high-severity messages are automatically escalated to the Intelligence Department for further action. Parsed message data is stored in a MariaDB database accessed through an ASP.NET Core API layer.\n\nKey stakeholders include:\n    - AppUser (Police Officer) – Primary user who manages TikTok messages.\n    - Intelligence Department – Receives emergency tickets or high-priority alerts.\n    - External TikTok Users – Public individuals who send DMs to the officer’s TikTok account.\n    - Developers & Administrators – Maintain the system, oversee integrations, and ensure security.\n\nBy centralizing TikTok DMs in one secure interface, MeldMonitor reduces the manual workload of monitoring, reporting, and escalating time-sensitive messages. The overall goal is to improve public safety response times while protecting sensitive data under strict security and privacy policies.",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 2,
        "title": "Level 1 diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "position": {
              "x": 230,
              "y": 230
            },
            "size": {
              "width": 140,
              "height": 140
            },
            "attrs": {
              "label": {
                "text": "Internal network"
              }
            },
            "visible": true,
            "shape": "trust-boundary-box",
            "zIndex": -1,
            "id": "48d0694f-c559-45a8-be39-52fda5997af7",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Internal network",
              "description": "Trust Boundary",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 250,
              "y": 260
            },
            "size": {
              "width": 100,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "MeldMonitor"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "56f00718-1709-46b4-96d0-ca7401d4e560"
                },
                {
                  "group": "right",
                  "id": "2150888b-afe2-4133-bd32-e52c7fa361c3"
                },
                {
                  "group": "bottom",
                  "id": "1e472243-1899-429c-89a1-9af08ab505b6"
                },
                {
                  "group": "left",
                  "id": "19d6d102-5620-421d-bc13-4e5c5efa3122"
                }
              ]
            },
            "id": "c5df3399-3406-443a-acee-5773d7dd3f5a",
            "data": {
              "type": "tm.Process",
              "name": "MeldMonitor",
              "description": "The central system for handling law enforcement messages. It pulls direct messages from TikTok, categorizes them based on urgency, and sends serious cases to the Intelligence Department.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            },
            "children": []
          },
          {
            "position": {
              "x": 500,
              "y": 200
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "TikTok"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 2,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "d6d2e43b-865e-4efb-9d14-a8f3cbc1385b"
                },
                {
                  "group": "right",
                  "id": "92ae3bea-8129-4bf1-b38f-20fed5271ee0"
                },
                {
                  "group": "bottom",
                  "id": "ae58f5fa-9619-44d0-90be-e10f8f476d10"
                },
                {
                  "group": "left",
                  "id": "28bdcbed-b28d-4606-a877-1d5a8ba1ba7d"
                }
              ]
            },
            "id": "7485cdc4-4f02-44c7-b66b-2bd75a81e9fb",
            "data": {
              "type": "tm.Actor",
              "name": "TikTok",
              "description": "An external social media service where people can send messages to the officer’s TikTok business account. MeldMonitor retrieves these messages from TikTok.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 20,
              "y": 270
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "AppUser"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "d6d2e43b-865e-4efb-9d14-a8f3cbc1385b"
                },
                {
                  "group": "right",
                  "id": "92ae3bea-8129-4bf1-b38f-20fed5271ee0"
                },
                {
                  "group": "bottom",
                  "id": "ae58f5fa-9619-44d0-90be-e10f8f476d10"
                },
                {
                  "group": "left",
                  "id": "28bdcbed-b28d-4606-a877-1d5a8ba1ba7d"
                }
              ]
            },
            "id": "f2067612-7d58-4c3b-beda-c14f28fcf89e",
            "data": {
              "type": "tm.Actor",
              "name": "AppUser",
              "description": "A police officer who uses a TikTok business account. This user logs in through MeldMonitor to view, manage, and potentially forward messages.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 500,
              "y": 330
            },
            "size": {
              "width": 160,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Intelligence department"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 4,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "d6d2e43b-865e-4efb-9d14-a8f3cbc1385b"
                },
                {
                  "group": "right",
                  "id": "92ae3bea-8129-4bf1-b38f-20fed5271ee0"
                },
                {
                  "group": "bottom",
                  "id": "ae58f5fa-9619-44d0-90be-e10f8f476d10"
                },
                {
                  "group": "left",
                  "id": "28bdcbed-b28d-4606-a877-1d5a8ba1ba7d"
                }
              ]
            },
            "id": "0333952b-6f74-471d-9709-e2ef20edf7de",
            "data": {
              "type": "tm.Actor",
              "name": "Intelligence department",
              "description": "A law enforcement unit that receives urgent or high-risk alerts sent by MeldMonitor. This team investigates and responds to critical cases.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Data Flow"
            ],
            "id": "af850a5c-856a-4e2e-ab36-68fd3f5ec738",
            "source": {
              "cell": "f2067612-7d58-4c3b-beda-c14f28fcf89e",
              "port": "92ae3bea-8129-4bf1-b38f-20fed5271ee0"
            },
            "target": {
              "cell": "c5df3399-3406-443a-acee-5773d7dd3f5a",
              "port": "19d6d102-5620-421d-bc13-4e5c5efa3122"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Data Flow"
            ],
            "id": "678d220f-488e-4e21-816a-1e81ff4e79d9",
            "source": {
              "cell": "c5df3399-3406-443a-acee-5773d7dd3f5a",
              "port": "2150888b-afe2-4133-bd32-e52c7fa361c3"
            },
            "target": {
              "cell": "7485cdc4-4f02-44c7-b66b-2bd75a81e9fb",
              "port": "28bdcbed-b28d-4606-a877-1d5a8ba1ba7d"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Data Flow"
            ],
            "id": "b2ba05d7-fe1d-4524-8d66-2bf735d4b3c7",
            "source": {
              "cell": "c5df3399-3406-443a-acee-5773d7dd3f5a",
              "port": "2150888b-afe2-4133-bd32-e52c7fa361c3"
            },
            "target": {
              "cell": "0333952b-6f74-471d-9709-e2ef20edf7de",
              "port": "28bdcbed-b28d-4606-a877-1d5a8ba1ba7d"
            },
            "vertices": []
          }
        ],
        "description": "This high-level view shows how external entities (the TikTok Platform, AppUser, and Intelligence Department) interact with MeldMonitor as a single system boundary. It highlights the primary data flows into and out of MeldMonitor without detailing internal components."
      },
      {
        "id": 3,
        "title": "Level 2 diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "position": {
              "x": 5,
              "y": 175.00000000000006
            },
            "size": {
              "width": 850,
              "height": 630
            },
            "attrs": {
              "label": {
                "text": "MeldMonitor Internal Network"
              }
            },
            "visible": true,
            "shape": "trust-boundary-box",
            "zIndex": -1,
            "id": "98c49b57-c510-4deb-9310-1cef77b85184",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "MeldMonitor Internal Network",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 350,
              "y": 190
            },
            "size": {
              "width": 160,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Mobile App \n[Ionic/Typescript]"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "25d6639b-99d9-4de5-bb32-43447ccc38c8"
                },
                {
                  "group": "right",
                  "id": "4fb6ba1d-570c-48bc-8167-2846ac113d16"
                },
                {
                  "group": "bottom",
                  "id": "8499fafd-62c6-43ed-977c-7b103be7be31"
                },
                {
                  "group": "left",
                  "id": "36552dd0-249a-4507-8bea-5bd342a20dcf"
                }
              ]
            },
            "id": "fa93b87b-1347-44f4-80b0-9e5b8f080a97",
            "data": {
              "type": "tm.Process",
              "name": "Mobile App \n[Ionic/Typescript]",
              "description": "Ionic/Typescript",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "b2962ea0-9b61-4ae7-b706-262d45af5415",
                  "title": "S-F2",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Attacker forges or steals the mobile app’s credentials/token to call the API as if from the real app",
                  "mitigation": "Use short-lived OAuth/JWT tokens, validate device or app signatures, monitor for token reuse",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": "8"
                },
                {
                  "id": "5d832915-afc7-4f84-a07c-4f1d43497a52",
                  "title": "R-F2",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Repudiation",
                  "description": "An officer denies making certain API calls; the system lacks logs or correlation IDs to prove otherwise.",
                  "mitigation": "Implement server-side logging with user ID/time stamps for each request, store minimal but sufficient evidence.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": "6"
                },
                {
                  "id": "0a7b9b67-c58a-4171-9141-35e577146a99",
                  "title": "I-F2",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Sensitive data (like personal details or DM content) is readable if the connection is leaked or logs are stored plain text.",
                  "mitigation": "Encrypt all data in transit (HTTPS), sanitize logs, use partial or tokenized data fields.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": "8"
                },
                {
                  "id": "86d8edee-1bc8-44ee-8c13-a08439197ea6",
                  "title": "E-F2",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Hidden API endpoints might be discovered by analyzing the app, letting attackers call privileged routes.",
                  "mitigation": "Restrict access with role-based checks on the API, separate admin endpoints on a different route or domain.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 18,
                  "score": "8"
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 0,
                "repudiation": 1,
                "informationDisclosure": 2,
                "denialOfService": 0,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 355,
              "y": 420.00000000000006
            },
            "size": {
              "width": 150,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "API Application\n[ASP.NET Core]"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 2,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "25d6639b-99d9-4de5-bb32-43447ccc38c8"
                },
                {
                  "group": "right",
                  "id": "4fb6ba1d-570c-48bc-8167-2846ac113d16"
                },
                {
                  "group": "bottom",
                  "id": "8499fafd-62c6-43ed-977c-7b103be7be31"
                },
                {
                  "group": "left",
                  "id": "36552dd0-249a-4507-8bea-5bd342a20dcf"
                }
              ]
            },
            "id": "bcc6924f-50d6-4f9b-afdf-748375a6a8a1",
            "data": {
              "type": "tm.Process",
              "name": "API Application\n[ASP.NET Core]",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "d9514e1b-4153-408b-bdb0-6f843fc6755a",
                  "title": "S-F3",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "The API reuses a shared DB credential that an attacker or insider can steal, posing as the API.",
                  "mitigation": "Use unique credentials per service, IP whitelisting, rotate DB passwords or use secrets manager.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 22,
                  "score": "8"
                },
                {
                  "id": "cc34a41c-9e3c-4fa1-98be-32d62771c61e",
                  "title": "T-F3",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Malicious SQL injection or parameter tampering modifies queries from the API to the DB, leading to corrupted data.",
                  "mitigation": "Parameterize all queries, use an ORM that sanitizes inputs, implement strict DB privileges.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 23,
                  "score": "9"
                },
                {
                  "id": "7c158549-9b1f-4bb0-ae9a-b8e61facae89",
                  "title": "I-F3",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Query results returning raw DM or user data could be logged in plain text or remain visible to unauthorized processes.",
                  "mitigation": "Mask sensitive fields in logs, encrypt data at rest, limit SELECT permissions to necessary columns.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 24,
                  "score": "8"
                },
                {
                  "id": "d3a4156e-c0b9-4bb4-ac94-f84188c383ce",
                  "title": "D-F3",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Flooding the DB with complex queries or large data sets can degrade performance or cause timeouts.",
                  "mitigation": "Use query time limits, implement caching, set concurrency caps, monitor for abnormal query patterns.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": "7"
                },
                {
                  "id": "7383aa61-8464-41b4-b1ba-bc5466d510ab",
                  "title": "E-F3",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "The API uses DB credentials with admin rights, letting it create/destroy tables or escalate beyond normal CRUD.",
                  "mitigation": "Adopt least-privilege DB accounts, separate read/write roles, regularly audit DB user privileges.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 26,
                  "score": "8"
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 700,
              "y": 190
            },
            "size": {
              "width": 140,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "DataDrip\n(TikTok Integration)"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "25d6639b-99d9-4de5-bb32-43447ccc38c8"
                },
                {
                  "group": "right",
                  "id": "4fb6ba1d-570c-48bc-8167-2846ac113d16"
                },
                {
                  "group": "bottom",
                  "id": "8499fafd-62c6-43ed-977c-7b103be7be31"
                },
                {
                  "group": "left",
                  "id": "36552dd0-249a-4507-8bea-5bd342a20dcf"
                }
              ]
            },
            "id": "b3856a1b-1d04-41a6-a7a8-91f8dbd22dfa",
            "data": {
              "type": "tm.Process",
              "name": "DataDrip\n(TikTok Integration)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "14cb8984-9e9b-4a92-925e-1239a67d7cbc",
                  "title": "S-F4",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Spoofing",
                  "description": "A service mimics the API or spoofs an internal token, calling DataDrip to retrieve unauthorized TikTok data.",
                  "mitigation": "Require mutual TLS or signed requests between API and DataDrip, verify internal network addresses.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 33,
                  "score": "8"
                },
                {
                  "id": "a9fc3413-d944-49e5-923e-1337cfc02ec4",
                  "title": "T-F4",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "The parameters (user IDs or access tokens) sent to DataDrip are altered en route, leading to retrieval of other users’ data.",
                  "mitigation": "Enforce TLS, implement request signing, validate user/tokens in DataDrip.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 34,
                  "score": "8"
                },
                {
                  "id": "c04aa473-1c9f-4ed0-959f-3c27ffc6f800",
                  "title": "R-F4",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "The API denies sending certain requests to DataDrip if no call logs or transaction IDs exist.",
                  "mitigation": "Store request/response logs with timestamps, keep correlation IDs in both systems.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 35,
                  "score": "6"
                },
                {
                  "id": "708b7048-490f-4a24-945b-938dbf72b0ae",
                  "title": "I-F4",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "DataDrip logs or processes might store TikTok tokens in plain text, exposing them if logs are compromised.",
                  "mitigation": "Mask tokens in logs, store only hashed references, restrict who can view DataDrip’s logs.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 36,
                  "score": "8"
                },
                {
                  "id": "63afe3e7-aa5d-4ed1-9374-75bc79c2bdd0",
                  "title": "D-F4",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "The API repeatedly calls DataDrip with huge or frequent requests, causing it to hit resource limits or crash.",
                  "mitigation": "Apply usage quotas for the API, add request throttling in DataDrip, monitor for unusual traffic spikes.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 37,
                  "score": "7"
                },
                {
                  "id": "5c0f5a05-54a8-4240-8bab-80b32d0b8937",
                  "title": "E-F4",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "DataDrip might allow the API to use privileged scopes that can read or alter more data than intended.",
                  "mitigation": "Implement scope-limited tokens, enforce principle of least privilege in DataDrip configurations.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 38,
                  "score": "8"
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 24.25,
              "y": 425.00000000000006
            },
            "size": {
              "width": 120,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Message \nCategorizer\n[Python]"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 4,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "25d6639b-99d9-4de5-bb32-43447ccc38c8"
                },
                {
                  "group": "right",
                  "id": "4fb6ba1d-570c-48bc-8167-2846ac113d16"
                },
                {
                  "group": "bottom",
                  "id": "8499fafd-62c6-43ed-977c-7b103be7be31"
                },
                {
                  "group": "left",
                  "id": "36552dd0-249a-4507-8bea-5bd342a20dcf"
                }
              ]
            },
            "id": "954f6749-4da3-4e38-9425-2bd6cf205b70",
            "data": {
              "type": "tm.Process",
              "name": "Message \nCategorizer\n[Python]",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "9ab71e95-6bfa-4ab6-a18c-023b02ab0f78",
                  "title": "S-F6",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An unauthorized process claims to be the API, sending requests to the categorizer directly.",
                  "mitigation": "Implement internal authentication (API keys or mutual TLS) for any calls to the categorizer.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 44,
                  "score": "8"
                },
                {
                  "id": "30e8e728-ca0f-4bcb-a715-7b3eb8c9a472",
                  "title": "T-F6",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The data about DMs is manipulated, skewing classification results or injecting malicious payloads into the AI.",
                  "mitigation": "Validate and sanitize input before passing to the categorizer, log anomalies.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 45,
                  "score": "8"
                },
                {
                  "id": "0bdeb3f1-d1b0-4602-b82d-150a35e4633c",
                  "title": "R-F6",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "The API denies sending certain data for classification if no correlation or request ID is recorded.",
                  "mitigation": "Log all classification requests with unique IDs, timestamps, and the requesting user context.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 46,
                  "score": "6"
                },
                {
                  "id": "5e045a42-7770-4b08-9d9c-d857cf43f16f",
                  "title": "I-F6",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Raw DM content is passed in plain text to the categorizer or ends up in debug logs.",
                  "mitigation": "Mask or hash sensitive content, restrict log access.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 47,
                  "score": "8"
                },
                {
                  "id": "b6f50d8f-0813-49cd-bcec-edd02d56eaca",
                  "title": "D-F6",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Large or fast requests to the ML service overload the categorizer, causing crashes.",
                  "mitigation": "Implement concurrency limits, queue requests, monitor resource usage (CPU/RAM).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 48,
                  "score": "7"
                },
                {
                  "id": "e6be0045-b8ec-49d6-a193-ccea3657daf0",
                  "title": "E-F6",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "The categorizer runs under elevated OS or container permissions that the API exploits to gain system-level access.",
                  "mitigation": "Run the categorizer in a access-control environment, enforce sandboxing.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 49,
                  "score": "6"
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 370,
              "y": 710
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Database\n[MariaDB]"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 5,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "a357f3c1-884b-40a6-8cd5-91e2e9cb3f76"
                },
                {
                  "group": "right",
                  "id": "7f00113f-0b96-42d2-98e8-bf39c74ca345"
                },
                {
                  "group": "bottom",
                  "id": "8ca1a915-919f-4e80-9a37-dd1c7dbbef3b"
                },
                {
                  "group": "left",
                  "id": "6438ddb0-e295-4a26-944f-e96a80eea336"
                }
              ]
            },
            "id": "2702df3d-9c15-4fed-b1bf-42201033ec5d",
            "data": {
              "type": "tm.Store",
              "name": "Database\n[MariaDB]",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "9beeafaa-c4a8-4bca-b950-4cbcb56a7609",
                  "title": "R-F3",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Developer or admin denies deleting/updating records in the DB if there are no audit logs.",
                  "mitigation": "Configure DB-level audit logs, store transaction logs with user context from the API.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 27,
                  "score": "6"
                },
                {
                  "id": "6659d1c0-2b43-4f30-a1cb-ca19f7fa9a05",
                  "title": "D-F3",
                  "status": "Open",
                  "severity": "High",
                  "type": "Repudiation",
                  "description": "Flooding the DB with complex queries or large data sets can degrade performance or cause timeouts.",
                  "mitigation": "Use query time limits, implement caching, set concurrency caps, monitor for abnormal query patterns.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 28,
                  "score": "7"
                },
                {
                  "id": "7d6311a7-2691-4ccb-8db9-3f93604e933d",
                  "title": "E-F3",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "The API uses DB credentials with admin rights, letting it create/destroy tables or escalate beyond normal CRUD.",
                  "mitigation": "Adopt least-privilege DB accounts, separate read/write roles, regularly audit DB user privileges.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 29,
                  "score": "8"
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 2,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 713.75,
              "y": 10
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "TikTok\n(External)"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 6,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "052d45a6-d94a-4de8-bec3-df8d8ed8a8b5"
                },
                {
                  "group": "right",
                  "id": "bb3c0eb9-4c12-457e-908e-5f543d0ae59d"
                },
                {
                  "group": "bottom",
                  "id": "7a2664d8-a1bf-42b2-bdf0-9e74ffb29b0e"
                },
                {
                  "group": "left",
                  "id": "b6d6368b-a326-4f6e-a644-d899ee125753"
                }
              ]
            },
            "id": "66f54085-530f-443a-8188-e0d9ea0f8e74",
            "data": {
              "type": "tm.Actor",
              "name": "TikTok\n(External)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "01403e30-8535-4134-8cbd-97b0e90b267c",
                  "title": "S-F5",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "A fake or compromised endpoint pretends to be TikTok’s API (DNS hijack), intercepting DataDrip calls.",
                  "mitigation": "Validate domain with certificate pinning, DNSSEC, track pinned IP addresses if possible.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 42,
                  "score": "6"
                },
                {
                  "id": "73d02cf8-1b81-4074-b447-5db352bd0e71",
                  "title": "R-F5",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "TikTok or DataDrip denies certain requests or partial DM retrieval if logs are incomplete.",
                  "mitigation": "Keep call logs with request IDs, store timestamps on both ends, align them with known user sessions.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 43,
                  "score": "4"
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "repudiation": 1
              }
            }
          },
          {
            "position": {
              "x": 373.75,
              "y": 10
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "AppUser\n(Police Officer)"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 7,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "052d45a6-d94a-4de8-bec3-df8d8ed8a8b5"
                },
                {
                  "group": "right",
                  "id": "bb3c0eb9-4c12-457e-908e-5f543d0ae59d"
                },
                {
                  "group": "bottom",
                  "id": "7a2664d8-a1bf-42b2-bdf0-9e74ffb29b0e"
                },
                {
                  "group": "left",
                  "id": "b6d6368b-a326-4f6e-a644-d899ee125753"
                }
              ]
            },
            "id": "8b6f187f-2827-41e4-98db-1c2ef97aa6c0",
            "data": {
              "type": "tm.Actor",
              "name": "AppUser\n(Police Officer)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "a2609fc4-6a68-4196-8c6e-24766fc9f406",
                  "title": "S-F1",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Attacker impersonates the officer by stealing or guessing device credentials, then launching the mobile app as the legitimate user",
                  "mitigation": "Strong device passcode policies and short-lived session tokens",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": "8"
                },
                {
                  "id": "61fd25f5-1ef8-4a5e-b925-3c4d1b9ddb3c",
                  "title": "R-F1",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Officer or attacker denies having performed certain actions on the mobile device (“I never tapped that button”)",
                  "mitigation": "local app logs (hashed/timestamped) plus server-side logs correlating device actions with user identity",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": "6"
                }
              ],
              "threatFrequency": {
                "spoofing": 3,
                "repudiation": 1
              }
            }
          },
          {
            "position": {
              "x": 900,
              "y": 500
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Intelligence\ndepartment\n(External)"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 8,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "052d45a6-d94a-4de8-bec3-df8d8ed8a8b5"
                },
                {
                  "group": "right",
                  "id": "bb3c0eb9-4c12-457e-908e-5f543d0ae59d"
                },
                {
                  "group": "bottom",
                  "id": "7a2664d8-a1bf-42b2-bdf0-9e74ffb29b0e"
                },
                {
                  "group": "left",
                  "id": "b6d6368b-a326-4f6e-a644-d899ee125753"
                }
              ]
            },
            "id": "b66f4a93-8986-43cc-999f-144452c32f7f",
            "data": {
              "type": "tm.Actor",
              "name": "Intelligence\ndepartment\n(External)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "5dce4a01-bd65-4ad5-9045-9d7958712307",
                  "title": "S-F8",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "A service or attacker acts as the legitimate API, sending fake alerts to the Intelligence Department.",
                  "mitigation": "Use mutual TLS or secure tokens to verify the API’s identity, sign all forwarded alerts.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 60,
                  "score": "6"
                },
                {
                  "id": "7fe0ca88-8b6f-466a-8524-fc24178e07f8",
                  "title": "R-F8",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "The Intelligence Department claims it never received certain alerts, or the API denies sending them, if no proof of delivery.",
                  "mitigation": "Use request/response acknowledgments, maintain logs on both sides with unique ticket IDs.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 61,
                  "score": "5"
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "repudiation": 1
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "F5: TikTok API calls",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "115f2d23-b34b-435b-b1c3-ffafd926d1ce",
                  "title": "T-F5",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Man-in-the-middle modifies data in transit to or from TikTok if TLS is broken or certificates are invalid.",
                  "mitigation": "TLS enforcement, certificate transparency checks, monitor for certificate anomalies.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 39,
                  "score": "8"
                },
                {
                  "id": "1c09b6aa-1a0c-4851-9ced-baea5ea2687c",
                  "title": "I-F5",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "DataDrip requests overly broad scopes from TikTok, exposing additional user data or profile details.",
                  "mitigation": "Use minimal OAuth scopes, regularly audit which data is actually needed.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 40,
                  "score": "8"
                },
                {
                  "id": "fdf56862-99a4-4e16-aa67-3a9f4a1b4777",
                  "title": "D-F5",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "TikTok rate-limits or blocks DataDrip if it floods the API with excessive requests, halting DM retrieval.",
                  "mitigation": "Request scheduling, observe TikTok’s usage limit.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 41,
                  "score": "5"
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "F5: TikTok API calls"
            ],
            "id": "a406361a-3505-4023-936e-9d203372dbee",
            "source": {
              "cell": "b3856a1b-1d04-41a6-a7a8-91f8dbd22dfa",
              "port": "25d6639b-99d9-4de5-bb32-43447ccc38c8"
            },
            "target": {
              "cell": "66f54085-530f-443a-8188-e0d9ea0f8e74",
              "port": "7a2664d8-a1bf-42b2-bdf0-9e74ffb29b0e"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "F6: Data for categorization",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "a5db36ee-2af3-462d-9e49-d25855d8f6d0",
                  "title": "T-F6",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The data about DMs is manipulated, skewing classification results or injecting malicious payloads into the AI.",
                  "mitigation": "Validate and sanitize input before passing to the categorizer, log anomalies.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 50,
                  "score": "8"
                },
                {
                  "id": "a8e076a9-09a0-4854-8159-c328f802c3ca",
                  "title": "I-F6",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Raw DM content is passed in plain text to the categorizer or ends up in debug logs.",
                  "mitigation": "Mask or hash sensitive content, restrict log access.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 51,
                  "score": "8"
                },
                {
                  "id": "ffa5af05-5136-4b77-b250-deedb804e749",
                  "title": "D-F6",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Denial of service",
                  "description": "Large or fast requests to the ML service overburden the categorizer, causing slowdowns or crashes.",
                  "mitigation": "Implement limits, queue requests, monitor resource usage (CPU/RAM).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 52,
                  "score": "7"
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "F6: Data for categorization"
            ],
            "id": "2cd49cb1-7cd3-4213-8ef5-f42b279de048",
            "source": {
              "cell": "bcc6924f-50d6-4f9b-afdf-748375a6a8a1",
              "port": "36552dd0-249a-4507-8bea-5bd342a20dcf"
            },
            "target": {
              "cell": "954f6749-4da3-4e38-9425-2bd6cf205b70",
              "port": "4fb6ba1d-570c-48bc-8167-2846ac113d16"
            },
            "vertices": [
              {
                "x": 260,
                "y": 450
              },
              {
                "x": 230,
                "y": 450
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "F7: Categorization results",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "e9f45048-09fd-41fb-95ca-5e17f477e062",
                  "title": "T-F7",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Classification output is modified in transit, potentially causing the API to record incorrect severity or incident data.",
                  "mitigation": "Sign classification results, use TLS, or store ephemeral references that can’t be altered externally.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 54,
                  "score": "8"
                },
                {
                  "id": "3b0ba896-b012-4ce3-b24a-65dcd0644d2a",
                  "title": "I-F7",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "The categorizer’s output might include extra data about the messages or user, exposing it in the API logs.",
                  "mitigation": "Return only necessary classification labels, mask raw content or user data.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 55,
                  "score": "8"
                },
                {
                  "id": "47b65524-7c7a-4a2e-aa29-b4dc8fcb6373",
                  "title": "D-F7",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "If the categorizer overloads the API with repeated or malformed responses, the API could crash.",
                  "mitigation": "Validate inbound data from the categorizer, limit request frequency, set timeouts.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 56,
                  "score": "5"
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "F7: Categorization results"
            ],
            "id": "f0c5d628-ad3c-4d78-96c8-e978d5cf9b9e",
            "source": {
              "cell": "954f6749-4da3-4e38-9425-2bd6cf205b70",
              "port": "4fb6ba1d-570c-48bc-8167-2846ac113d16"
            },
            "target": {
              "cell": "bcc6924f-50d6-4f9b-afdf-748375a6a8a1",
              "port": "36552dd0-249a-4507-8bea-5bd342a20dcf"
            },
            "vertices": [
              {
                "x": 240,
                "y": 510
              },
              {
                "x": 250,
                "y": 510
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "F1: User Inputs / Requests",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "acf0d213-ff2e-43a8-a215-0f830426c2a1",
                  "title": "T-F1",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Malicious actor intercepts or modifies the user’s requests (e.g. text input) on an insecure network before they reach the mobile app.",
                  "mitigation": "Use end-to-end TLS, verify integrity of requests on the mobile side, encourage officers to avoid untrusted Wi-Fi.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": "5"
                },
                {
                  "id": "d7dca8ed-c319-4dc5-b460-e08ff32cc607",
                  "title": "I-F1",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Sensitive data (e.g. session tokens, user info) is exposed if the device or initial app handshake is unencrypted or if logs store raw credentials.",
                  "mitigation": "Enforce HTTPS/TLS on all connections, mask or encrypt logs, use secure storage for tokens.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": "8"
                },
                {
                  "id": "9e969a60-58a6-48fd-92bb-f55fffd994d9",
                  "title": "D-F1",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Repeated malicious requests from a device overload the app, making it unusable.",
                  "mitigation": "Implement rate limiting at the local app or server, detect abnormal usage patterns, forced logout.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": "5"
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "F1: User Inputs / Requests"
            ],
            "id": "91cefbde-1e2f-40d4-8091-80d7f753a6b2",
            "source": {
              "cell": "8b6f187f-2827-41e4-98db-1c2ef97aa6c0",
              "port": "7a2664d8-a1bf-42b2-bdf0-9e74ffb29b0e"
            },
            "target": {
              "cell": "fa93b87b-1347-44f4-80b0-9e5b8f080a97",
              "port": "25d6639b-99d9-4de5-bb32-43447ccc38c8"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "F8: Forward Alerts / Tickets",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "9cb4631f-39fa-44c3-9c11-9892a5acc542",
                  "title": "T-F8",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The forwarded tickets or reports are altered in transit.",
                  "mitigation": "Sign the data, enforce TLS, store a hash of the ticket content for verification.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 57,
                  "score": "8"
                },
                {
                  "id": "ab001f72-ee8d-4c81-bd9c-05b10f1c27c5",
                  "title": "I-F8",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Detailed incident data (or personal info) might be over-shared with the Intelligence Department if encryption or filtering is missing.",
                  "mitigation": "Provide only the relevant fields in the alert, encrypt sensitive fields, apply role-based access for intelligence officers.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 58,
                  "score": "8"
                },
                {
                  "id": "a4b5f2af-bcf5-40ad-9edf-d9cebbf3d909",
                  "title": "D-F8",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "The API repeatedly overloads the Intelligence Department’s system with excessive or malformed tickets, disrupting normal triage.",
                  "mitigation": "Rate-limit the forwarding process, require department-side acknowledgment before sending more.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 59,
                  "score": "5"
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "F8: Forward Alerts / Tickets"
            ],
            "id": "0f2f9042-dda0-458e-9981-b09b13b9a625",
            "source": {
              "x": 480,
              "y": 530
            },
            "target": {
              "cell": "b66f4a93-8986-43cc-999f-144452c32f7f",
              "port": "b6d6368b-a326-4f6e-a644-d899ee125753"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "F4: Retrieve TikTok DMs",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "eb268655-5601-482b-9ae7-cac137f6a48a",
                  "title": "T-F4",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The parameters (user IDs or access tokens) sent to DataDrip are altered en route, leading to retrieval of other users’ data.",
                  "mitigation": "Enforce TLS, implement request signing, validate user/tokens in DataDrip.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 30,
                  "score": "8"
                },
                {
                  "id": "920b84ba-68a5-4329-9829-a7fc81028901",
                  "title": "I-F4",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "DataDrip logs or processes might store TikTok tokens in plain text, exposing them if logs are compromised.",
                  "mitigation": "Mask tokens in logs, store only hashed references, restrict who can view DataDrip’s logs.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 31,
                  "score": "8"
                },
                {
                  "id": "070eacff-7891-458c-b868-65ff6183806b",
                  "title": "D-F4",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "The API repeatedly calls DataDrip with huge or frequent requests, causing it to hit resource limits or crash.",
                  "mitigation": "Apply usage quotas for the API, add request throttling in DataDrip, monitor for unusual traffic spikes.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 32,
                  "score": "7"
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "F4: Retrieve TikTok DMs"
            ],
            "id": "bf3ce691-04ea-4c61-a193-d491bd6e26c5",
            "source": {
              "cell": "bcc6924f-50d6-4f9b-afdf-748375a6a8a1",
              "port": "4fb6ba1d-570c-48bc-8167-2846ac113d16"
            },
            "target": {
              "cell": "b3856a1b-1d04-41a6-a7a8-91f8dbd22dfa",
              "port": "8499fafd-62c6-43ed-977c-7b103be7be31"
            },
            "vertices": [
              {
                "x": 700,
                "y": 360
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "F2: HTTP Request to API",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "66cd5680-4935-4110-89f7-a908e8aa8517",
                  "title": "I-F2",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Sensitive data (like personal details or DM content) is readable if the connection is leaked or logs are stored plain text.",
                  "mitigation": "Encrypt all data in transit (HTTPS), sanitize logs, use partial or tokenized data fields.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 15,
                  "score": "8"
                },
                {
                  "id": "f40b6e90-62e9-4149-8f33-a23b40660399",
                  "title": "D-F2",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Bot or malware repeatedly sends massive requests from the app side, overwhelming the API’s capacity.",
                  "mitigation": "Enforce server rate limiting, apply WAF rules, add re-auth or captcha after suspicious volume.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": "7"
                },
                {
                  "id": "a754b248-839c-4159-b281-dfce7b7c7651",
                  "title": "T-F2",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The JSON payload en route to the API is altered, inserting malicious parameters or removing crucial fields.",
                  "mitigation": "Enforce TLS 1.2 or higher, use request signing/HMAC or schema validation on the API side.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 53,
                  "score": "8"
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 2,
                "denialOfService": 2
              }
            },
            "labels": [
              "F2: HTTP Request to API"
            ],
            "id": "48915d17-e1ac-46d6-a8d9-9d82abc2af93",
            "source": {
              "cell": "fa93b87b-1347-44f4-80b0-9e5b8f080a97",
              "port": "8499fafd-62c6-43ed-977c-7b103be7be31"
            },
            "target": {
              "cell": "bcc6924f-50d6-4f9b-afdf-748375a6a8a1",
              "port": "25d6639b-99d9-4de5-bb32-43447ccc38c8"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "F3: SQL Queries / EF calls",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "442fa720-e244-4099-8601-9fd45ca36f3d",
                  "title": "T-F3",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Malicious SQL injection or parameter tampering modifies queries from the API to the DB, leading to corrupted data.",
                  "mitigation": "Parameterize all queries, use an ORM that sanitizes inputs, implement strict DB privileges.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 19,
                  "score": "9"
                },
                {
                  "id": "7846bd3b-147c-4969-8539-d58ace4211c2",
                  "title": "I-F3",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Query results returning raw DM or user data could be logged in plain text or remain visible to unauthorized processes.",
                  "mitigation": "Mask sensitive fields in logs, encrypt data at rest, limit SELECT permissions to necessary columns.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 20,
                  "score": "8"
                },
                {
                  "id": "cd188930-859e-4162-8044-71ce5eafc564",
                  "title": "D-F3",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Flooding the DB with complex queries or large data sets can degrade performance or cause timeouts.",
                  "mitigation": "Use query time limits, implement caching, set concurrency caps, monitor for abnormal query patterns.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 21,
                  "score": "7"
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "F3: SQL Queries / EF calls"
            ],
            "id": "1cdcdfa3-48d8-4f99-bf5e-55f00d163d70",
            "source": {
              "cell": "bcc6924f-50d6-4f9b-afdf-748375a6a8a1",
              "port": "8499fafd-62c6-43ed-977c-7b103be7be31"
            },
            "target": {
              "cell": "2702df3d-9c15-4fed-b1bf-42201033ec5d",
              "port": "a357f3c1-884b-40a6-8cd5-91e2e9cb3f76"
            },
            "vertices": []
          }
        ],
        "description": "This expanded diagram displays MeldMonitor and its core internal components—Mobile App, API Application, DataDrip, Message Categorizer, and Database. Each data flow (F1, F2, etc.) is labeled to show the pathways for user input, TikTok data retrieval, message categorization, and final alerts to the Intelligence Department."
      }
    ],
    "diagramTop": 4,
    "reviewer": "",
    "threatTop": 61
  }
}